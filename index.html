<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìÖ Calendar Planner GLTH:ADüë©‚Äçüíª </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <style>
        body { box-sizing: border-box; height: 100%; margin: 0; font-family: 'Sarabun', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        html { height: 100%; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 1px; background-color: #e5e7eb; }
        .calendar-day { 
            background-color: white; 
            min-height: 120px; 
            padding: 4px; /* ‡∏•‡∏î padding */
            position: relative; 
            cursor: pointer;
            font-size: 0.8rem; /* ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏´‡∏•‡∏±‡∏Å‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ß‡∏±‡∏ô */
        } 
        .calendar-day.other-month { background-color: #f9fafb; color: #9ca3af; cursor: default; } 
        
        /* --- ‡∏™‡∏µ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á --- */
        .calendar-day.company-holiday {
            background-color: #fee2e2 !important; 
            border-left: none; 
        }
        .calendar-day.public-holiday {
            background-color: #ffedd5; 
            border-left: 4px solid #f97316; 
        }
        .calendar-day.buddhist-day {
            background-color: #fef9c3; 
            border-left: none; 
        }
        /* ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£/‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∞ ‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô */
        .holiday-label {
            font-size: 0.7rem; /* ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î */
            font-weight: 500;
            margin-bottom: 2px;
            overflow: hidden;
            max-height: 1.8em; /* ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏î‡πâ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 2 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î */
            line-height: 1.2;
        }

        /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ Event Item */
        .event-item { 
            background-color: #3b82f6; 
            color: white; 
            padding: 1px 4px; /* ‡∏•‡∏î padding */
            margin: 1px 0; /* ‡∏•‡∏î margin */
            border-radius: 4px; 
            font-size: 0.65rem; /* ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ */
            cursor: pointer; 
            overflow: hidden; 
            text-overflow: ellipsis; 
            white-space: nowrap; 
        }

        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1000; }
        .modal.show { display: flex; align-items: center; justify-content: center; }
        .spinner { border: 4px solid rgba(0, 0, 0, 0.1); width: 36px; height: 36px; border-radius: 50%; border-left-color: #3b82f6; animation: spin 1s ease infinite; margin: 20px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .day-number { pointer-events: none; font-size: 1rem; }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-50">
    <div class="container mx-auto p-6 max-w-6xl">
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h1 id="calendar-title" class="text-3xl font-bold text-gray-800 mb-4">Calendar Planner GLTH:ADüë©‚Äçüíª</h1>
            <div class="flex flex-wrap gap-4 items-center">
                <button id="add-event-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors"> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏´‡∏°‡πà </button>
                <div class="flex items-center gap-2">
                    <button id="prev-month" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg transition-colors"> ‚Üê ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô </button>
                    <span id="current-month" class="text-xl font-semibold text-gray-700 px-4 w-48 text-center"></span> <button id="next-month" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg transition-colors"> ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí </button>
                </div>
            </div>
            <div class="mt-4 flex flex-wrap gap-4 text-sm">
                <div class="flex items-center gap-2">
                    <div class="w-4 h-4 bg-red-100 rounded"></div>
                    <span class="text-gray-600">üî¥ ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø</span>
                </div>
                <div class="flex items-center gap-2">
                    <div class="w-4 h-4 bg-orange-100 border-l-4 border-orange-600 rounded"></div>
                    <span class="text-gray-600">üèõÔ∏è ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</span>
                </div>
                <div class="flex items-center gap-2">
                    <div class="w-4 h-4 bg-yellow-100 rounded"></div>
                    <span class="text-gray-600">üôè ‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∞</span>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏∞‡∏°‡∏≤‡∏ñ‡∏∂‡∏á (7 ‡∏ß‡∏±‡∏ô)</h2>
            <div id="upcoming-events" class="space-y-3">
                <div class="spinner"></div> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...
            </div>
        </div>

        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <div class="calendar-grid bg-gray-100 text-center font-semibold text-gray-700">
                <div class="p-4">‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå</div> <div class="p-4">‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</div> <div class="p-4">‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£</div> <div class="p-4">‡∏û‡∏∏‡∏ò</div> <div class="p-4">‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ</div> <div class="p-4">‡∏®‡∏∏‡∏Å‡∏£‡πå</div> <div class="p-4">‡πÄ‡∏™‡∏≤‡∏£‡πå</div>
            </div>
            <div id="calendar-days" class="calendar-grid">
                <div class="col-span-7 p-10 text-center text-gray-500">
                    <div class="spinner"></div> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...
                </div>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow-md p-6 mt-6">
            <h2 id="monthly-summary-title" class="text-xl font-bold text-gray-800 mb-4">‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô [‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏õ‡∏µ] </h2>
            <div id="monthly-summary-events" class="space-y-3">
                <p class="text-gray-500 text-center py-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</p>
            </div>
        </div>
    </div>

    <div id="add-event-modal" class="modal">
        <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
            <h2 class="text-xl font-bold text-gray-800 mb-4">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏´‡∏°‡πà</h2>
            <form id="add-event-form">
                <div class="mb-4"><label for="event-title" class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</label> <input type="text" id="event-title" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"></div>
                <div class="mb-4"><label for="event-date" class="block text-sm font-medium text-gray-700 mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label> <input type="date" id="event-date" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"></div>
                <div class="mb-4"><label for="event-time" class="block text-sm font-medium text-gray-700 mb-2">‡πÄ‡∏ß‡∏•‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label> <input type="time" id="event-time" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"></div>
                <div class="mb-4"><label for="event-description" class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label> <textarea id="event-description" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea></div>
                <div class="mb-6"><label for="event-author" class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°</label> <input type="text" id="event-author" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"></div>
                <div class="flex gap-3">
                    <button type="submit" id="save-event-btn" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg font-medium transition-colors"> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å </button>
                    <button type="button" id="cancel-event-btn" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 px-4 rounded-lg font-medium transition-colors"> ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å </button>
                </div>
            </form>
        </div>
    </div>

    <div id="event-details-modal" class="modal">
        <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
            <h2 class="text-xl font-bold text-gray-800 mb-4">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h2>
            <div id="event-details-content"></div>
            <div class="flex gap-3 mt-6">
                <button id="delete-event-btn" class="flex-1 bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-lg font-medium transition-colors"> ‡∏•‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° </button>
                <button id="close-details-btn" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 px-4 rounded-lg font-medium transition-colors"> ‡∏õ‡∏¥‡∏î </button>
            </div>
        </div>
    </div>

    <script>
        // --- Firebase Configuration for work-calendar-fe6c1 ---
        const firebaseConfig = {
          apiKey: "AIzaSyA6yXwcdOihGZcttFwdB6ax_Wb_S8NHMGQ",
          authDomain: "work-calendar-fe6c1.firebaseapp.com",
          databaseURL: "https://work-calendar-fe6c1-default-rtdb.asia-southeast1.firebasedatabase.app",
          projectId: "work-calendar-fe6c1",
          storageBucket: "work-calendar-fe6c1.firebasestorage.app",
          messagingSenderId: "792437599231",
          appId: "1:792437599231:web:2420688ca88867f57155ca",
          measurementId: "G-XK0NJMT3EG" 
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const eventsRef = db.ref("calendar_events"); 

        let currentDate = new Date();
        let allEvents = {}; 
        let selectedEventKey = null; 

        const thaiMonths = ['‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô', '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'];

        // --- ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£‡πÑ‡∏ó‡∏¢ (2568 - 2575) ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏ä‡∏∑‡πà‡∏≠ ---
        const thaiHolidays = {
            // 2568 (2025)
            '2025-01-01': '‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà', '2025-02-12': '‡∏°‡∏≤‡∏Ü‡∏ö‡∏π‡∏ä‡∏≤', '2025-04-06': '‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏Å‡∏£‡∏µ', '2025-04-07': '‡∏ä‡∏î‡πÄ‡∏ä‡∏¢‡∏à‡∏±‡∏Å‡∏£‡∏µ',
            '2025-04-13': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå', '2025-04-14': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå', '2025-04-15': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå', '2025-05-01': '‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô',
            '2025-05-04': '‡∏â‡∏±‡∏ï‡∏£‡∏°‡∏á‡∏Ñ‡∏•', '2025-05-05': '‡∏ä‡∏î‡πÄ‡∏ä‡∏¢‡∏â‡∏±‡∏ï‡∏£‡∏°‡∏á‡∏Ñ‡∏•', '2025-05-12': '‡∏ß‡∏¥‡∏™‡∏≤‡∏Ç‡∏ö‡∏π‡∏ä‡∏≤ (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', 
            '2025-06-03': '‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡∏ä‡∏ô‡∏°‡∏û‡∏£‡∏£‡∏©‡∏≤ ‡∏™‡∏∏‡∏ó‡∏¥‡∏î‡∏≤', '2025-07-28': '‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡∏ä‡∏ô‡∏°‡∏û‡∏£‡∏£‡∏©‡∏≤ ‡∏£.10',
            '2025-08-11': '‡∏≠‡∏≤‡∏™‡∏≤‡∏¨‡∏´‡∏ö‡∏π‡∏ä‡∏≤ (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2025-08-12': '‡∏ß‡∏±‡∏ô‡πÅ‡∏°‡πà/‡∏û‡∏±‡∏ô‡∏õ‡∏µ‡∏´‡∏•‡∏ß‡∏á', 
            '2025-10-13': '‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡∏ï ‡∏£.9', '2025-10-23': '‡∏õ‡∏¥‡∏¢‡∏°‡∏´‡∏≤‡∏£‡∏≤‡∏ä',
            '2025-12-05': '‡∏ß‡∏±‡∏ô‡∏û‡πà‡∏≠/‡∏£.9', '2025-12-10': '‡∏£‡∏±‡∏ê‡∏ò‡∏£‡∏£‡∏°‡∏ô‡∏π‡∏ç', '2025-12-31': '‡∏™‡∏¥‡πâ‡∏ô‡∏õ‡∏µ',

            // 2569 (2026)
            '2026-01-01': '‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà', '2026-03-04': '‡∏°‡∏≤‡∏Ü‡∏ö‡∏π‡∏ä‡∏≤', '2026-04-06': '‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏Å‡∏£‡∏µ',
            '2026-04-13': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå', '2026-04-14': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå', '2026-04-15': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå', '2026-05-01': '‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô',
            '2026-05-04': '‡∏â‡∏±‡∏ï‡∏£‡∏°‡∏á‡∏Ñ‡∏•', '2026-05-30': '‡∏ß‡∏¥‡∏™‡∏≤‡∏Ç‡∏ö‡∏π‡∏ä‡∏≤', '2026-06-03': '‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡∏ä‡∏ô‡∏°‡∏û‡∏£‡∏£‡∏©‡∏≤ ‡∏™‡∏∏‡∏ó‡∏¥‡∏î‡∏≤', 
            '2026-07-27': '‡∏≠‡∏≤‡∏™‡∏≤‡∏¨‡∏´‡∏ö‡∏π‡∏ä‡∏≤ (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2026-07-28': '‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡∏ä‡∏ô‡∏°‡∏û‡∏£‡∏£‡∏©‡∏≤ ‡∏£.10',
            '2026-08-12': '‡∏ß‡∏±‡∏ô‡πÅ‡∏°‡πà/‡∏û‡∏±‡∏ô‡∏õ‡∏µ‡∏´‡∏•‡∏ß‡∏á', '2026-10-13': '‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡∏ï ‡∏£.9', '2026-10-23': '‡∏õ‡∏¥‡∏¢‡∏°‡∏´‡∏≤‡∏£‡∏≤‡∏ä', 
            '2026-12-05': '‡∏ß‡∏±‡∏ô‡∏û‡πà‡∏≠/‡∏£.9', '2026-12-07': '‡∏ä‡∏î‡πÄ‡∏ä‡∏¢ ‡∏£.9', '2026-12-10': '‡∏£‡∏±‡∏ê‡∏ò‡∏£‡∏£‡∏°‡∏ô‡∏π‡∏ç', '2026-12-31': '‡∏™‡∏¥‡πâ‡∏ô‡∏õ‡∏µ',

            // 2570 (2027)
            '2027-01-01': '‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà', '2027-02-22': '‡∏°‡∏≤‡∏Ü‡∏ö‡∏π‡∏ä‡∏≤', '2027-04-06': '‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏Å‡∏£‡∏µ',
            '2027-04-13': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå', '2027-04-14': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå', '2027-04-15': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå', '2027-05-03': '‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)',
            '2027-05-04': '‡∏â‡∏±‡∏ï‡∏£‡∏°‡∏á‡∏Ñ‡∏•', '2027-05-15': '‡∏ß‡∏¥‡∏™‡∏≤‡∏Ç‡∏ö‡∏π‡∏ä‡∏≤', '2027-06-03': '‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡∏ä‡∏ô‡∏°‡∏û‡∏£‡∏£‡∏©‡∏≤ ‡∏™‡∏∏‡∏ó‡∏¥‡∏î‡∏≤', 
            '2027-07-26': '‡∏≠‡∏≤‡∏™‡∏≤‡∏¨‡∏´‡∏ö‡∏π‡∏ä‡∏≤ (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2027-07-28': '‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡∏ä‡∏ô‡∏°‡∏û‡∏£‡∏£‡∏©‡∏≤ ‡∏£.10',
            '2027-08-12': '‡∏ß‡∏±‡∏ô‡πÅ‡∏°‡πà/‡∏û‡∏±‡∏ô‡∏õ‡∏µ‡∏´‡∏•‡∏ß‡∏á', '2027-10-13': '‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡∏ï ‡∏£.9', '2027-10-25': '‡∏õ‡∏¥‡∏¢‡∏°‡∏´‡∏≤‡∏£‡∏≤‡∏ä (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', 
            '2027-12-06': '‡∏ß‡∏±‡∏ô‡∏û‡πà‡∏≠/‡∏£.9 (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2027-12-10': '‡∏£‡∏±‡∏ê‡∏ò‡∏£‡∏£‡∏°‡∏ô‡∏π‡∏ç', '2027-12-31': '‡∏™‡∏¥‡πâ‡∏ô‡∏õ‡∏µ',
            
            // 2571 (2028)
            '2028-01-03': '‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2028-02-11': '‡∏°‡∏≤‡∏Ü‡∏ö‡∏π‡∏ä‡∏≤', '2028-04-06': '‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏Å‡∏£‡∏µ',
            '2028-04-13': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå', '2028-04-14': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå', '2028-04-17': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2028-05-01': '‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô',
            '2028-05-04': '‡∏â‡∏±‡∏ï‡∏£‡∏°‡∏á‡∏Ñ‡∏•', '2028-05-08': '‡∏ß‡∏¥‡∏™‡∏≤‡∏Ç‡∏ö‡∏π‡∏ä‡∏≤ (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2028-06-05': '‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡∏ä‡∏ô‡∏°‡∏û‡∏£‡∏£‡∏©‡∏≤‡∏Ø (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', 
            '2028-07-28': '‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡∏ä‡∏ô‡∏°‡∏û‡∏£‡∏£‡∏©‡∏≤ ‡∏£.10', '2028-08-11': '‡∏ß‡∏±‡∏ô‡πÅ‡∏°‡πà/‡∏û‡∏±‡∏ô‡∏õ‡∏µ‡∏´‡∏•‡∏ß‡∏á (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', 
            '2028-10-13': '‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡∏ï ‡∏£.9', '2028-10-23': '‡∏õ‡∏¥‡∏¢‡∏°‡∏´‡∏≤‡∏£‡∏≤‡∏ä',
            '2028-12-05': '‡∏ß‡∏±‡∏ô‡∏û‡πà‡∏≠/‡∏£.9', '2028-12-11': '‡∏£‡∏±‡∏ê‡∏ò‡∏£‡∏£‡∏°‡∏ô‡∏π‡∏ç (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2029-01-01': '‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà',
            
            // 2572 (2029)
            '2029-01-02': '‡∏ä‡∏î‡πÄ‡∏ä‡∏¢‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà', '2029-02-28': '‡∏°‡∏≤‡∏Ü‡∏ö‡∏π‡∏ä‡∏≤', '2029-04-06': '‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏Å‡∏£‡∏µ',
            '2029-04-13': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå', '2029-04-16': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2029-04-17': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2029-05-01': '‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô',
            '2029-05-07': '‡∏â‡∏±‡∏ï‡∏£‡∏°‡∏á‡∏Ñ‡∏• (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2029-05-28': '‡∏ß‡∏¥‡∏™‡∏≤‡∏Ç‡∏ö‡∏π‡∏ä‡∏≤ (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2029-06-04': '‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡∏ä‡∏ô‡∏°‡∏û‡∏£‡∏£‡∏©‡∏≤‡∏Ø (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', 
            '2029-07-28': '‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡∏ä‡∏ô‡∏°‡∏û‡∏£‡∏£‡∏©‡∏≤ ‡∏£.10', '2029-08-13': '‡∏ß‡∏±‡∏ô‡πÅ‡∏°‡πà/‡∏û‡∏±‡∏ô‡∏õ‡∏µ‡∏´‡∏•‡∏ß‡∏á (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', 
            '2029-10-15': '‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡∏ï ‡∏£.9 (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2029-10-23': '‡∏õ‡∏¥‡∏¢‡∏°‡∏´‡∏≤‡∏£‡∏≤‡∏ä',
            '2029-12-05': '‡∏ß‡∏±‡∏ô‡∏û‡πà‡∏≠/‡∏£.9', '2029-12-10': '‡∏£‡∏±‡∏ê‡∏ò‡∏£‡∏£‡∏°‡∏ô‡∏π‡∏ç', '2029-12-31': '‡∏™‡∏¥‡πâ‡∏ô‡∏õ‡∏µ',
            
            // 2573 (2030)
            '2030-01-01': '‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà', '2030-02-18': '‡∏°‡∏≤‡∏Ü‡∏ö‡∏π‡∏ä‡∏≤', '2030-04-08': '‡∏à‡∏±‡∏Å‡∏£‡∏µ (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)',
            '2030-04-14': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå', '2030-04-15': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå', '2030-04-16': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2030-05-01': '‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô',
            '2030-05-06': '‡∏â‡∏±‡∏ï‡∏£‡∏°‡∏á‡∏Ñ‡∏• (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2030-05-18': '‡∏ß‡∏¥‡∏™‡∏≤‡∏Ç‡∏ö‡∏π‡∏ä‡∏≤', '2030-06-03': '‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡∏ä‡∏ô‡∏°‡∏û‡∏£‡∏£‡∏©‡∏≤ ‡∏™‡∏∏‡∏ó‡∏¥‡∏î‡∏≤', 
            '2030-07-28': '‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡∏ä‡∏ô‡∏°‡∏û‡∏£‡∏£‡∏©‡∏≤ ‡∏£.10', '2030-07-29': '‡∏ä‡∏î‡πÄ‡∏ä‡∏¢ ‡∏£.10', 
            '2030-08-12': '‡∏ß‡∏±‡∏ô‡πÅ‡∏°‡πà/‡∏û‡∏±‡∏ô‡∏õ‡∏µ‡∏´‡∏•‡∏ß‡∏á', '2030-10-14': '‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡∏ï ‡∏£.9 (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2030-10-23': '‡∏õ‡∏¥‡∏¢‡∏°‡∏´‡∏≤‡∏£‡∏≤‡∏ä',
            '2030-12-05': '‡∏ß‡∏±‡∏ô‡∏û‡πà‡∏≠/‡∏£.9', '2030-12-10': '‡∏£‡∏±‡∏ê‡∏ò‡∏£‡∏£‡∏°‡∏ô‡∏π‡∏ç', '2030-12-31': '‡∏™‡∏¥‡πâ‡∏ô‡∏õ‡∏µ',

            // 2574 (2031)
            '2031-01-01': '‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà', '2031-02-07': '‡∏°‡∏≤‡∏Ü‡∏ö‡∏π‡∏ä‡∏≤', '2031-04-07': '‡∏à‡∏±‡∏Å‡∏£‡∏µ (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)',
            '2031-04-14': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå', '2031-04-15': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå', '2031-04-16': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2031-05-01': '‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô',
            '2031-05-05': '‡∏â‡∏±‡∏ï‡∏£‡∏°‡∏á‡∏Ñ‡∏• (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2031-06-02': '‡∏ß‡∏¥‡∏™‡∏≤‡∏Ç‡∏ö‡∏π‡∏ä‡∏≤ (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2031-06-03': '‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡∏ä‡∏ô‡∏°‡∏û‡∏£‡∏£‡∏©‡∏≤ ‡∏™‡∏∏‡∏ó‡∏¥‡∏î‡∏≤', 
            '2031-07-28': '‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡∏ä‡∏ô‡∏°‡∏û‡∏£‡∏£‡∏©‡∏≤ ‡∏£.10', '2031-08-12': '‡∏ß‡∏±‡∏ô‡πÅ‡∏°‡πà/‡∏û‡∏±‡∏ô‡∏õ‡∏µ‡∏´‡∏•‡∏ß‡∏á', 
            '2031-10-13': '‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡∏ï ‡∏£.9', '2031-10-23': '‡∏õ‡∏¥‡∏¢‡∏°‡∏´‡∏≤‡∏£‡∏≤‡∏ä',
            '2031-12-08': '‡∏ß‡∏±‡∏ô‡∏û‡πà‡∏≠/‡∏£.9 (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2031-12-10': '‡∏£‡∏±‡∏ê‡∏ò‡∏£‡∏£‡∏°‡∏ô‡∏π‡∏ç', '2031-12-31': '‡∏™‡∏¥‡πâ‡∏ô‡∏õ‡∏µ',
            
            // 2575 (2032)
            '2032-01-01': '‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà', '2032-02-26': '‡∏°‡∏≤‡∏Ü‡∏ö‡∏π‡∏ä‡∏≤', '2032-04-05': '‡∏à‡∏±‡∏Å‡∏£‡∏µ (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)',
            '2032-04-13': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå', '2032-04-14': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå', '2032-04-15': '‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå', '2032-05-03': '‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)',
            '2032-05-04': '‡∏â‡∏±‡∏ï‡∏£‡∏°‡∏á‡∏Ñ‡∏•', '2032-05-17': '‡∏ß‡∏¥‡∏™‡∏≤‡∏Ç‡∏ö‡∏π‡∏ä‡∏≤ (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2032-06-03': '‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡∏ä‡∏ô‡∏°‡∏û‡∏£‡∏£‡∏©‡∏≤ ‡∏™‡∏∏‡∏ó‡∏¥‡∏î‡∏≤', 
            '2032-07-28': '‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡∏ä‡∏ô‡∏°‡∏û‡∏£‡∏£‡∏©‡∏≤ ‡∏£.10', '2032-08-12': '‡∏ß‡∏±‡∏ô‡πÅ‡∏°‡πà/‡∏û‡∏±‡∏ô‡∏õ‡∏µ‡∏´‡∏•‡∏ß‡∏á', 
            '2032-10-13': '‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡∏ï ‡∏£.9', '2032-10-25': '‡∏õ‡∏¥‡∏¢‡∏°‡∏´‡∏≤‡∏£‡∏≤‡∏ä (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)',
            '2032-12-06': '‡∏ß‡∏±‡∏ô‡∏û‡πà‡∏≠/‡∏£.9 (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)', '2032-12-10': '‡∏£‡∏±‡∏ê‡∏ò‡∏£‡∏£‡∏°‡∏ô‡∏π‡∏ç', '2033-01-03': '‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà (‡∏ä‡∏î‡πÄ‡∏ä‡∏¢)',
        };
        
        // --- ‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∞ (2568 - 2575) (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°) ---
        const buddhistHolyDays = [
            '2025-01-06', '2025-01-13', '2025-01-21', '2025-01-29', '2025-02-05', '2025-02-12', '2025-02-20', '2025-02-28',
            '2025-03-07', '2025-03-14', '2025-03-22', '2025-03-30', '2025-04-06', '2025-04-13', '2025-04-21', '2025-04-29',
            '2025-05-06', '2025-05-13', '2025-05-21', '2025-05-28', '2025-06-05', '2025-06-12', '2025-06-20', '2025-06-27',
            '2025-07-05', '2025-07-12', '2025-07-19', '2025-07-27', '2025-08-03', '2025-08-10', '2025-08-18', '2025-08-25',
            '2025-09-02', '2025-09-09', '2025-09-16', '2025-09-23', '2025-10-01', '2025-10-08', '2025-10-15', '2025-10-23',
            '2025-10-30', '2025-11-06', '2025-11-13', '2025-11-21', '2025-11-28', '2025-12-06', '2025-12-13', '2025-12-21',
            '2025-12-28', 
            '2026-01-04', '2026-01-12', '2026-01-19', '2026-01-27', '2026-02-03', '2026-02-11', '2026-02-18', '2026-02-26',
            '2026-03-06', '2026-03-13', '2026-03-21', '2026-03-28', '2026-04-05', '2026-04-12', '2026-04-20', '2026-04-27',
            '2026-05-05', '2026-05-12', '2026-05-20', '2026-05-28', '2026-06-04', '2026-06-11', '2026-06-19', '2026-06-26',
            '2026-07-04', '2026-07-11', '2026-07-18', '2026-07-26', '2026-08-02', '2026-08-09', '2026-08-17', '2026-08-24',
            '2026-08-31', '2026-09-08', '2026-09-15', '2026-09-22', '2026-09-30', '2026-10-07', '2026-10-14', '2026-10-22',
            '2026-10-29', '2026-11-05', '2026-11-12', '2026-11-20', '2026-11-27', '2026-12-05', '2026-12-12', '2026-12-20',
            '2026-12-27',
            '2027-01-04', '2027-01-11', '2027-01-19', '2027-01-27', '2027-02-03', '2027-02-11', '2027-02-18', '2027-02-26',
            '2027-03-05', '2027-03-12', '2027-03-20', '2027-03-27', '2027-04-04', '2027-04-11', '2027-04-19', '2027-04-26',
            '2027-05-04', '2027-05-11', '2027-05-19', '2027-05-26', '2027-06-03', '2027-06-10', '2027-06-17', '2027-06-25',
            '2027-07-02', '2027-07-09', '2027-07-16', '2027-07-24', '2027-08-01', '2027-08-08', '2027-08-16', '2027-08-23',
            '2027-08-31', '2027-09-07', '2027-09-14', '2027-09-21', '2027-09-29', '2027-10-06', '2027-10-13', '2027-10-21',
            '2027-10-28', '2027-11-05', '2027-11-12', '2027-11-19', '2027-11-27', '2027-12-04', '2027-12-11', '2027-12-19',
            '2027-12-26',
            '2028-01-03', '2028-01-10', '2028-01-18', '2028-01-26', '2028-02-02', '2028-02-09', '2028-02-17', '2028-02-25',
            '2028-03-03', '2028-03-10', '2028-03-18', '2028-03-26', '2028-04-03', '2028-04-10', '2028-04-17', '2028-04-25',
            '2028-05-02', '2028-05-09', '2028-05-16', '2028-05-24', '2028-06-01', '2028-06-08', '2028-06-15', '2028-06-23',
            '2028-06-30', '2028-07-07', '2028-07-14', '2028-07-22', '2028-07-30', '2028-08-06', '2028-08-13', '2028-08-21',
            '2028-08-28', '2028-09-05', '2028-09-12', '2028-09-19', '2028-09-27', '2028-10-04', '2028-10-11', '2028-10-19',
            '2028-10-26', '2028-11-03', '2028-11-10', '2028-11-18', '2028-11-25', '2028-12-03', '2028-12-10', '2028-12-18',
            '2028-12-25',
            '2029-01-01', '2029-01-08', '2029-01-16', '2029-01-24', '2029-01-31', '2029-02-07', '2029-02-15', '2029-02-23',
            '2029-03-03', '2029-03-10', '2029-03-18', '2029-03-25', '2029-04-02', '2029-04-09', '2029-04-16', '2029-04-24',
            '2029-05-01', '2029-05-08', '2029-05-15', '2029-05-23', '2029-05-30', '2029-06-06', '2029-06-13', '2029-06-21',
            '2029-06-28', '2029-07-05', '2029-07-12', '2029-07-20', '2029-07-27', '2029-08-04', '2029-08-11', '2029-08-18',
            '2029-08-26', '2029-09-03', '2029-09-10', '2029-09-17', '2029-09-25', '2029-10-02', '2029-10-09', '2029-10-17',
            '2029-10-24', '2029-11-01', '2029-11-08', '2029-11-15', '2029-11-23', '2029-11-30', '2029-12-07', '2029-12-15',
            '2029-12-22', '2029-12-30',
            '2030-01-06', '2030-01-14', '2030-01-21', '2030-01-29', '2030-02-05', '2030-02-12', '2030-02-20', '2030-02-27',
            '2030-03-07', '2030-03-14', '2030-03-22', '2030-03-29', '2030-04-06', '2030-04-13', '2030-04-21', '2030-04-29',
            '2030-05-06', '2030-05-13', '2030-05-21', '2030-05-28', '2030-06-05', '2030-06-12', '2030-06-20', '2030-06-27',
            '2030-07-05', '2030-07-12', '2030-07-19', '2030-07-27', '2030-08-03', '2030-08-10', '2030-08-18', '2030-08-25',
            '2030-09-02', '2030-09-09', '2030-09-16', '2030-09-23', '2030-10-01', '2030-10-08', '2030-10-15', '2030-10-23',
            '2030-10-30', '2030-11-06', '2030-11-13', '2030-11-21', '2030-11-28', '2030-12-06', '2030-12-13', '2030-12-21',
            '2030-12-28',
            '2031-01-05', '2031-01-12', '2031-01-20', '2031-01-28', '2031-02-04', '2031-02-12', '2031-02-19', '2031-02-27',
            '2031-03-06', '2031-03-13', '2031-03-21', '2031-03-28', '2031-04-05', '2031-04-12', '2031-04-20', '2031-04-27',
            '2031-05-05', '2031-05-12', '2031-05-20', '2031-05-27', '2031-06-04', '2031-06-11', '2031-06-19', '2031-06-26',
            '2031-07-04', '2031-07-11', '2031-07-18', '2031-07-26', '2031-08-03', '2031-08-10', '2031-08-18', '2031-08-25',
            '2031-09-02', '2031-09-09', '2031-09-16', '2031-09-23', '2031-10-01', '2031-10-08', '2031-10-15', '2031-10-23',
            '2031-10-30', '2031-11-06', '2031-11-13', '2031-11-21', '2031-11-28', '2031-12-06', '2031-12-13', '2031-12-21',
            '2031-12-28',
            '2032-01-05', '2032-01-12', '2032-01-20', '2032-01-27', '2032-02-04', '2032-02-11', '2032-02-19', '2032-02-27',
            '2032-03-05', '2032-03-12', '2032-03-20', '2032-03-27', '2032-04-04', '2032-04-11', '2032-04-19', '2032-04-26',
            '2032-05-04', '2032-05-11', '2032-05-18', '2032-05-25', '2032-06-02', '2032-06-09', '2032-06-16', '2032-06-24',
            '2032-07-01', '2032-07-08', '2032-07-15', '2032-07-23', '2032-07-30', '2032-08-07', '2032-08-14', '2032-08-22',
            '2032-08-29', '2032-09-05', '2032-09-13', '2032-09-20', '2032-09-27', '2032-10-05', '2032-10-12', '2032-10-20',
            '2032-10-27', '2032-11-04', '2032-11-11', '2032-11-18', '2032-11-26', '2032-12-03', '2032-12-10', '2032-12-18',
            '2032-12-25'
        ];
        
        // Helper function to check if an event is a custom company holiday
        function isCustomCompanyHoliday(events) {
            return events.some(([key, event]) => 
                event.title && event.title.includes('üî¥ ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø')
            );
        }
        
        function getEventsForDateStr(dateStr) {
            return Object.entries(allEvents).filter(([key, event]) => event.date === dateStr);
        }


        // --- Function: Render Calendar ---
        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            document.getElementById('current-month').textContent = `${thaiMonths[month]} ${year + 543}`;

            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDayOfWeek = firstDay.getDay();
            const prevMonthLastDay = new Date(year, month, 0).getDate();

            const calendarDaysEl = document.getElementById('calendar-days');
            calendarDaysEl.innerHTML = ''; 

            // Previous month days
            for (let i = startingDayOfWeek - 1; i >= 0; i--) {
                const dayDiv = createDayElement(prevMonthLastDay - i, true, null); 
                calendarDaysEl.appendChild(dayDiv);
            }

            // Current month days
            for (let day = 1; day <= daysInMonth; day++) {
                const dateObj = new Date(year, month, day);
                const dayDiv = createDayElement(day, false, dateObj); 
                calendarDaysEl.appendChild(dayDiv);
            }

            // Next month days to fill grid rows properly
            const totalCells = calendarDaysEl.children.length;
            const remainingCells = (totalCells <= 35) ? (42 - totalCells) : (49 - totalCells); 

            let nextMonthDay = 1;
            for (let i = 0; i < remainingCells; i++) {
                const dayDiv = createDayElement(nextMonthDay++, true, null); 
                calendarDaysEl.appendChild(dayDiv);
            }

            // Call new summary functions
            renderUpcomingEvents();
            renderMonthlySummary();
        }

        // --- Function: Create Day Element (‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á) ---
        function createDayElement(day, isOtherMonth, dateObj) {
            const dayDiv = document.createElement('div');
            dayDiv.className = `calendar-day ${isOtherMonth ? 'other-month' : ''}`;

            let dayLabel = `<div class="font-semibold mb-1 day-number">${day}</div>`; 
            const dateStr = dateObj ? `${dateObj.getFullYear()}-${String(dateObj.getMonth() + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}` : '';

            if (!isOtherMonth && dateObj) {
                
                const dayEvents = getEventsForDateStr(dateStr);
                const isCustomHoliday = isCustomCompanyHoliday(dayEvents); 

                // --- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ---
                if (isCustomHoliday) {
                    // 1. ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó (‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á)
                    dayDiv.classList.add('company-holiday');
                    const holidayEvent = dayEvents.find(([key, event]) => event.title && event.title.includes('üî¥ ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø'));
                    // ‡πÉ‡∏ä‡πâ class 'holiday-label' ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á
                    dayLabel += `<div class="text-red-700 holiday-label pointer-events-none">${holidayEvent ? holidayEvent[1].title : 'üî¥ ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø'}</div>`;
                
                } else if (thaiHolidays[dateStr]) {
                    // 2. ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£ (‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡πà‡∏≠)
                    dayDiv.classList.add('public-holiday');
                    const holidayName = thaiHolidays[dateStr];
                    // ‡πÉ‡∏ä‡πâ class 'holiday-label' ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á
                    dayLabel += `<div class="text-orange-700 holiday-label pointer-events-none">üèõÔ∏è ${holidayName}</div>`;
                
                } else if (buddhistHolyDays.includes(dateStr)) {
                    // 3. ‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∞
                    dayDiv.classList.add('buddhist-day');
                     // ‡πÉ‡∏ä‡πâ class 'holiday-label' ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á
                    dayLabel += `<div class="text-yellow-700 holiday-label pointer-events-none">üôè ‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∞</div>`;
                }
                // --- ‡∏à‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î ---
                
                // Add events ordered by time
                const eventsToDisplay = dayEvents.sort(([, a], [, b]) => {
                    const timeA = a.time || '99:99'; 
                    const timeB = b.time || '99:99';
                    return timeA.localeCompare(timeB);
                });
                
                eventsToDisplay.forEach(([key, event]) => { 
                    // Filter out duplicate holiday labels if multiple events exist (or just the holiday itself)
                    const isHolidayEventTitle = event.title && (
                        event.title.includes('üî¥ ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø') ||
                        event.title.includes('üèõÔ∏è ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£') ||
                        event.title.includes('üôè ‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∞')
                    );
                    
                    if (!isHolidayEventTitle || eventsToDisplay.length > 1) {
                         const eventDiv = document.createElement('div');
                         eventDiv.className = 'event-item';
                         eventDiv.textContent = event.time ? `${event.time} ${event.title}` : event.title;
                         eventDiv.title = `${event.title}${event.time ? ' ('+event.time+')': ''}${event.description ? ' - '+event.description : ''} (‡πÇ‡∏î‡∏¢ ${event.author})`; 
                         eventDiv.onclick = (e) => {
                             e.stopPropagation(); 
                             showEventDetails(key, event);
                         };
                         dayDiv.appendChild(eventDiv);
                    }
                });

                // Click on day to add event
                dayDiv.onclick = () => {
                    document.getElementById('event-date').value = dateStr;
                    showAddEventModal();
                };

            } else {
                dayDiv.onclick = null; 
            }

            // Combine day label and event divs
            const tempContainer = document.createElement('div');
            tempContainer.innerHTML = dayLabel;
            while(dayDiv.firstChild) {
                tempContainer.appendChild(dayDiv.firstChild);
            }
            dayDiv.appendChild(tempContainer);

            return dayDiv;
        }

        // --- Function: Render Upcoming Events (New Filter) ---
        function renderUpcomingEvents() {
            const upcomingContainer = document.getElementById('upcoming-events');
            const today = new Date();
            today.setHours(0, 0, 0, 0); 
            const nextWeek = new Date(today.getTime() + 7 * 24 * 60 * 60 * 1000); 

            const upcomingEvents = Object.entries(allEvents)
                .map(([key, event]) => ({ key, ...event })) 
                .filter(event => {
                    try {
                        const eventDate = new Date(event.date + 'T00:00:00'); 
                        if (isNaN(eventDate)) return false; 
                        
                        // 1. Check date range
                        const isUpcoming = eventDate >= today && eventDate < nextWeek;
                        if (!isUpcoming) return false;

                        // 2. Exclude holiday events based on title
                        const eventTitle = event.title || '';
                        const isExcludedHoliday = eventTitle.includes('üî¥ ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø') || 
                                                  eventTitle.includes('üèõÔ∏è ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£') || 
                                                  eventTitle.includes('üôè ‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∞') ||
                                                  eventTitle.includes('‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£'); 

                        if (isExcludedHoliday) {
                            return false;
                        }
                        
                        return true;
                    } catch (e) {
                        console.warn("Skipping event with potentially invalid date:", event);
                        return false;
                    }
                })
                .sort((a, b) => {
                    const timeA = a.time ? `T${a.time}:00` : 'T00:00:00';
                    const timeB = b.time ? `T${b.time}:00` : 'T00:00:00';
                    const dateA = new Date(a.date + timeA);
                    const dateB = new Date(b.date + timeB);
                    
                    return dateA - dateB;
                });

            if (upcomingEvents.length === 0) {
                upcomingContainer.innerHTML = '<p class="text-gray-500 text-center py-4">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏°‡∏≤‡∏ñ‡∏∂‡∏á‡πÉ‡∏ô 7 ‡∏ß‡∏±‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤</p>';
                return;
            }

            upcomingContainer.innerHTML = upcomingEvents.map(event => {
                const eventDate = new Date(event.date + 'T00:00:00'); 
                const formattedDate = `${eventDate.getDate()} ${thaiMonths[eventDate.getMonth()]}`;
                const tomorrow = new Date(today.getTime() + 24 * 60 * 60 * 1000);

                let dateLabel = formattedDate;
                if (eventDate.toDateString() === today.toDateString()) dateLabel = '‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ';
                else if (eventDate.toDateString() === tomorrow.toDateString()) dateLabel = '‡∏û‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏µ‡πâ';

                const eventJsonString = JSON.stringify(event).replace(/"/g, '&quot;');
                
                // Use generic blue styling since holidays are filtered out
                const bgColor = 'bg-blue-50 border-blue-500';

                return `
                    <div class="flex items-start justify-between p-3 ${bgColor} rounded-lg border-l-4 cursor-pointer hover:bg-blue-100" onclick='showEventDetails("${event.key}", ${eventJsonString})'>
                        <div class="flex-1 mr-4 overflow-hidden">
                            <div class="font-semibold text-gray-800 truncate" title="${event.title}">${event.title}</div>
                            <div class="text-sm text-gray-600">${dateLabel}${event.time ? ` ‡πÄ‡∏ß‡∏•‡∏≤ ${event.time}` : ''}</div>
                            ${event.description ? `<div class="text-sm text-gray-500 mt-1 truncate" title="${event.description}">${event.description}</div>` : ''}
                        </div>
                        <div class="text-xs text-gray-500 text-right whitespace-nowrap">‡πÇ‡∏î‡∏¢ ${event.author}</div>
                    </div>
                `;
            }).join('');
        }

        // --- Function: Render Monthly Summary (New Function) ---
        function renderMonthlySummary() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const currentMonthName = thaiMonths[month];

            document.getElementById('monthly-summary-title').textContent = `‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${currentMonthName} ${year + 543} `;
            const summaryContainer = document.getElementById('monthly-summary-events');

            const monthlyEvents = Object.entries(allEvents)
                .map(([key, event]) => ({ key, ...event }))
                .filter(event => {
                    // 1. Filter by current month
                    const eventDate = new Date(event.date + 'T00:00:00'); 
                    if (isNaN(eventDate) || eventDate.getFullYear() !== year || eventDate.getMonth() !== month) {
                        return false;
                    }

                    // 2. Exclude holiday events based on title
                    const eventTitle = event.title || '';
                    const isExcludedHoliday = eventTitle.includes('üî¥ ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø') || 
                                              eventTitle.includes('üèõÔ∏è ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£') || 
                                              eventTitle.includes('üôè ‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∞') ||
                                              eventTitle.includes('‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£'); 

                    if (isExcludedHoliday) {
                        return false;
                    }
                    
                    return true;
                })
                .sort((a, b) => {
                    // Sort by date and then time
                    const timeA = a.time ? `T${a.time}:00` : 'T00:00:00';
                    const timeB = b.time ? `T${b.time}:00` : 'T00:00:00';
                    const dateA = new Date(a.date + timeA);
                    const dateB = new Date(b.date + timeB);
                    
                    return dateA - dateB;
                });

            if (monthlyEvents.length === 0) {
                summaryContainer.innerHTML = '<p class="text-gray-500 text-center py-4">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</p>';
                return;
            }

            summaryContainer.innerHTML = monthlyEvents.map(event => {
                const eventDate = new Date(event.date + 'T00:00:00'); 
                const formattedDate = `${eventDate.getDate()} ${thaiMonths[eventDate.getMonth()]}`;
                
                const eventJsonString = JSON.stringify(event).replace(/"/g, '&quot;');
                
                return `
                    <div class="flex items-start justify-between p-3 bg-blue-50 border-blue-500 rounded-lg border-l-4 cursor-pointer hover:bg-blue-100" onclick='showEventDetails("${event.key}", ${eventJsonString})'>
                        <div class="flex-1 mr-4 overflow-hidden">
                            <div class="font-semibold text-gray-800 truncate" title="${event.title}">${event.title}</div>
                            <div class="text-sm text-gray-600">${formattedDate}${event.time ? ` ‡πÄ‡∏ß‡∏•‡∏≤ ${event.time}` : ''}</div>
                            ${event.description ? `<div class="text-sm text-gray-500 mt-1 truncate" title="${event.description}">${event.description}</div>` : ''}
                        </div>
                        <div class="text-xs text-gray-500 text-right whitespace-nowrap">‡πÇ‡∏î‡∏¢ ${event.author}</div>
                    </div>
                `;
            }).join('');
        }

        // --- Functions ‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á) ---
        function showAddEventModal() { document.getElementById('add-event-modal').classList.add('show'); document.getElementById('event-title').focus(); }
        function hideAddEventModal() { document.getElementById('add-event-modal').classList.remove('show'); document.getElementById('add-event-form').reset(); }
        function showEventDetails(key, event) {
            selectedEventKey = key; 
            const content = document.getElementById('event-details-content');
            const eventDate = new Date(event.date + 'T00:00:00');
            let formattedDate = "Invalid Date";
            if (!isNaN(eventDate)) {
                 formattedDate = `${eventDate.getDate()} ${thaiMonths[eventDate.getMonth()]} ${eventDate.getFullYear() + 543}`;
            }

            content.innerHTML = `<div class="space-y-3"><div><span class="font-semibold text-gray-700">‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°:</span> <p class="text-gray-800 break-words">${event.title || '-'}</p></div><div><span class="font-semibold text-gray-700">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</span> <p class="text-gray-800">${formattedDate}</p></div>${event.time ? `<div><span class="font-semibold text-gray-700">‡πÄ‡∏ß‡∏•‡∏≤:</span> <p class="text-gray-800">${event.time}</p></div>` : ''}${event.description ? `<div><span class="font-semibold text-gray-700">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î:</span> <p class="text-gray-800 break-words">${event.description}</p></div>` : ''}<div><span class="font-semibold text-gray-700">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏î‡∏¢:</span> <p class="text-gray-800 break-words">${event.author || '-'}</p></div></div>`;
            document.getElementById('event-details-modal').classList.add('show');
        }
        function hideEventDetails() { document.getElementById('event-details-modal').classList.remove('show'); selectedEventKey = null; }

        async function addEventToFirebase(eventData) {
            const saveBtn = document.getElementById('save-event-btn');
            saveBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...'; saveBtn.disabled = true;

            try {
                if (!eventData.title || !eventData.date || !eventData.author) {
                     throw new Error("Missing required fields: title, date, or author.");
                }
                if (!/^\d{4}-\d{2}-\d{2}$/.test(eventData.date)) {
                    throw new Error("Invalid date format. Use YYYY-MM-DD.");
                }
                if (eventData.time && !/^\d{2}:\d{2}$/.test(eventData.time)) {
                     throw new Error("Invalid time format. Use HH:MM.");
                }

                await eventsRef.push({
                    title: eventData.title,
                    date: eventData.date,
                    time: eventData.time || null, 
                    description: eventData.description || null, 
                    author: eventData.author,
                    created_at: firebase.database.ServerValue.TIMESTAMP 
                });
                hideAddEventModal();
                showMessage('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'success');
            } catch (error) {
                console.error("Error adding event:", error);
                showMessage(`‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`, 'error');
            } finally {
                 saveBtn.textContent = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å'; saveBtn.disabled = false;
            }
        }

        async function deleteEventFromFirebase() {
            if (!selectedEventKey) return;
            if (!confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ô‡∏µ‡πâ?')) return; 

            const deleteBtn = document.getElementById('delete-event-btn');
            deleteBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏ö...'; deleteBtn.disabled = true;

            try {
                await eventsRef.child(selectedEventKey).remove();
                hideEventDetails();
                showMessage('‡∏•‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'success');
            } catch (error) {
                console.error("Error deleting event:", error);
                showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
            } finally {
                 deleteBtn.textContent = '‡∏•‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°'; deleteBtn.disabled = false;
            }
        }

        function showMessage(message, type) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `fixed bottom-4 right-4 px-6 py-3 rounded-lg text-white z-[1001] shadow-lg ${type === 'success' ? 'bg-green-600' : 'bg-red-600'}`; 
            messageDiv.textContent = message;
            document.body.appendChild(messageDiv);
            setTimeout(() => {
                messageDiv.style.opacity = '0'; 
                messageDiv.style.transition = 'opacity 0.5s ease';
                setTimeout(() => messageDiv.remove(), 500); 
             }, 3000);
        }

        // --- Event Listeners ---
        document.getElementById('add-event-btn').onclick = () => {
             const dateInput = document.getElementById('event-date');
             if (!dateInput.value) {
                 const today = new Date();
                 dateInput.value = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
             }
             showAddEventModal();
        };
        document.getElementById('cancel-event-btn').onclick = hideAddEventModal;
        document.getElementById('close-details-btn').onclick = hideEventDetails;
        document.getElementById('delete-event-btn').onclick = deleteEventFromFirebase; 
        document.getElementById('prev-month').onclick = () => { currentDate.setMonth(currentDate.getMonth() - 1); renderCalendar(); };
        document.getElementById('next-month').onclick = () => { currentDate.setMonth(currentDate.getMonth() + 1); renderCalendar(); };
        document.getElementById('add-event-form').onsubmit = (e) => {
            e.preventDefault();
            addEventToFirebase({ 
                title: document.getElementById('event-title').value.trim(),
                date: document.getElementById('event-date').value,
                time: document.getElementById('event-time').value,
                description: document.getElementById('event-description').value.trim(),
                author: document.getElementById('event-author').value.trim()
            });
        };
        document.getElementById('add-event-modal').onclick = (e) => { if (e.target.id === 'add-event-modal') hideAddEventModal(); };
        document.getElementById('event-details-modal').onclick = (e) => { if (e.target.id === 'event-details-modal') hideEventDetails(); };

        // --- Firebase Listener ---
        eventsRef.on('value', (snapshot) => {
            allEvents = snapshot.val() || {}; 
            console.log("Data from Firebase:", allEvents); 
            renderCalendar(); 
        }, (error) => {
             console.error("Firebase read failed:", error);
             document.getElementById('calendar-days').innerHTML = '<div class="col-span-7 p-10 text-center text-red-600">‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Firebase ‡πÅ‡∏•‡∏∞ Rules</div>';
             document.getElementById('upcoming-events').innerHTML = '<div class="p-10 text-center text-red-600">‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</div>';
             document.getElementById('monthly-summary-events').innerHTML = '<div class="p-10 text-center text-red-600">‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</div>';
             showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Firebase ‡πÑ‡∏î‡πâ', 'error');
        });

    </script>
</body>
</html>
